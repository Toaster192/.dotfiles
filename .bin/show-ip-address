#!/usr/bin/env bash

readonly argv0="$0"
# readonly url='https://api.ipify.org'
readonly url='https://ip.mariya.ch'
declare -i full=0

usage() {
    echo "usage: $argv0 [-f]"
    exit 1
}

indent() {
    sed 's/^/          /'
}

while getopts f OPT; do
    case $OPT in
        f) full=1 ;;
        *) usage ;;
    esac
done
shift $((OPTIND - 1))
OPTIND=1

netName=$(ip link show | grep 'UP mode' | tail -1 | awk '{ print $2 }')â¤¶

netName=${netName::-2}

if [[ ${netName:0:3} == "wlp"  ]] ; then
    echo "SSID:     $(netctl-auto list | grep -Po "\\* ${netName}-\\K.*")"
fi

echo "Internal: $(ip address show "$netName" | grep -Po 'inet \K[\d.]+')"

if ((full)); then
    echo "External: $(curl -s "$url")"
fi
